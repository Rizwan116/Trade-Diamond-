<!DOCTYPE html>
<?php include('common_header.php'); ?>

<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Trade Diamond Cart </title>
    <!-- base:css -->
    <link rel="stylesheet" href="vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="vendors/base/vendor.bundle.base.css">
    <!-- endinject -->
    <!-- plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="css/style.css">
    <!-- endinject -->
    <link rel="shortcut icon" href="../diamand/images/dimamondfav.png"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</head>

<style>
    /*        start littel logos section with tons of images*/


    .logos-section {
        text-align: center;
        background: #fff;
    }

    .container-fluid {
        margin-right: auto;
        margin-left: auto;
        padding-left: 15px;
        padding-right: 15px;
    }

    .logos-section h2 {
        color: #35393d;
        margin: 0 0 54px;
        font: 36px 'Hind Vadodara', sans-serif;
        padding-top: 57px;
    }

    .logos-list > li {
        display: inline-block;
        vertical-align: middle;
    }

    .logos-list {
        list-style: none;
        padding: 0;
        font-size: 0;
        line-height: 0;
        font-family: 'AdobeBlank';
        padding-bottom: 100px;
    }

    .logos-list .logo-image {
        position: relative;
        overflow: hidden;
        display: inline-block;
        margin-bottom: 50px;
    }

    .logos-list .logo-image img {
        max-height: 40px;
        display: block;
        width: auto;
        max-width: 100%;
    }

    .logos-list.logos-trusted .logo-image.logo-01 img {
        padding: 0px 56px 0px 0px;
    }

    .logos-list.logos-trusted .logo-image img {
        max-height: 50px !important;
    }

    .logos-list .logo-image.logo-01 img {
        padding: 0px 58px 0px 0px;
    }

    .logos-list .logo-image.logo-02 img {
        padding: 0px 58px 0px 0px;
    }

    .logos-list .logo-image.logo-03 img {
        padding: 0px 58px 0px 0px;
    }

    .logos-list .logo-image.logo-04 img {
        padding: 0px 58px 0px 0px;
    }

    /*        ends littel logos section with tons of images*/


    /*        start app area images and get app playstore*/


    .app-area-img {
        max-height: 655px;
        max-width: 100%;
        /*            position: absolute;*/
        height: 655px;
        top: 0;
        right: 0;
        z-index: 1;
    }

    .app-area-img {
        max-height: 655px;
        max-width: 100%;
    }

    .app-area-img {
        position: absolute;
        height: 655px;
        top: 0;
        right: 1px;
        z-index: 1;
    }

    .app-area-body h3 {
        font-size: 36px;
        margin-top: 82px;
        margin-bottom: 25px;
        color: #62657a;
    }

    .app-area-body p {
        font-family: 'Hind Vadodara', sans-serif;
        line-height: 25px;
        color: #626482;
        font-size: 13;
        line-height: 1.9;
    }

    .app-area-link {
        display: block;
        border: 2px;
        border-radius: 4px;
        border-style: solid;
        border-color: #c0c0c0;
        text-transform: uppercase;
        font-size: 15px;
        margin-left: 35px;
        margin-right: 40px;

        margin-top: 21px;
        margin-bottom: 105px;
    }

    .app-area-link:hover, .app-area-link:focus {
        border-color: #00ADE6;
        color: #fff;
        box-shadow: 3px 5.196px 18px 0px rgba(0, 0, 0, 0.25);
        background-color: #00ADE6;
    }

    .app-area-link:hover {
        text-decoration: none;
    }

    .apple-link img {
        margin-left: auto;
        margin-right: auto;
        /*    padding: 10px;*/
        display: block;
        max-width: 100%;
        height: auto;
    }

    .google-link img {
        margin-left: auto;
        margin-right: auto;
        /*    padding: 10px;*/
        display: block;
        max-width: 100%;
        height: auto;
    }

    .bts {
        color: aqua;
    }

    .app-area {
        position: relative;
        height: 580px;
    }

    /*        ends app area images and get app playstore*/


</style>


<body>
<div class="container-scroller">

    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
        <div class="main-panel" style="
    background-image: linear-gradient(hsla(0, 0%, 92%, 0.61),hsla(0,0%,100%,.6)),url(../diamand/images/landing-background.png);
    background-position: top;
    background-color: hsla(0,0%,100%,.9);
    ">

            <div class="content-wrapper">
                <div class="container mt-5">
                    <div class="row">
                        <div class="col-sm-6 mb-4 mb-xl-0">
                            <div class="d-lg-flex align-items-center">
                                <div style="/*padding: 35px*/">
                                    <h3  class="text-info font-weight-bold mt-2">Refresh and see </h3>
                                    <h2 class="text-dark font-weight-bold">You can add your diamonds to your cart</h2>
                                    <h5 class="font-weight-normal mb-2">you can also download in other docs and files</h5>

                                </div>

                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="d-flex align-items-center justify-content-md-end">
                                <div class="pr-1 mb-3 mb-xl-0">

                                </div>

                                <div class="pr-1 mb-3 mb-xl-0">

                                    <a href="#">
                                        <button type="button" class="btn btn-outline-inverse-info btn-icon-text"  title="download in words">
                                            Download
                                            <i class="mdi mdi-file-word"></i>
                                        </button>
                                    </a>
                                </div>

                            </div>
                        </div>

                        <!-- Modal -->

                    </div>

                <div class="row mt-4">
                    <div class="col-lg-8 grid-margin stretch-card">
                        <!--                            the class was card-->
                        <div class="#">
                            <div class="card-body">
                                <div class="row">



                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 mb-3 mb-lg-0">

                    </div>
                </div>


                <div class="container">

                    <div class="row" id="cart_list">
                        <div id="names" class="col-sm-12 stretch-card grid-margin">

                        </div>

                    </div>


                </div>
                <!-- content-wrapper ends -->
                <!-- partial:partials/_footer.html -->

                <!-- partial -->
            </div>
            <!-- main-panel ends -->
        </div>
        <!-- page-body-wrapper ends -->
    </div>


</div>


<?php include('../diamand/footer.php'); ?>


<script>
    var docData = [];
    $(function () {
        $('#search').keyup(function () {
            var val = $(this).val().toLowerCase();

            $("#names .card").hide();

            $("#names   .card").each(function () {

                var text = $(this).text().toLowerCase();

                if (text.indexOf(val) != -1) {

                    $(this).show();
                }
            });
        });

        var db = firebase.firestore();
        firebase.database().ref("cart").child(<?php echo $userId ?>).once("value", function (snap) {
            var m = 0;
            snap.forEach(function (childNodes) {
                var x = childNodes.key;

                var docRef = db.collection("diamond").doc(x);

                docRef.get().then(function (doc) {

                    if (doc.exists) {
                        docData.push(doc);
                        var refData = '<div class="col-sm-3 stretch-card grid-margin" id="card'+x+'">\n' +
                            '    <div class="card" >\n' +
                            '        <div class="card-body p-0">\n' +
                            '            <img class="img-fluid w-100" src="'+doc.data().image_url+'" alt="" style="width:100%; height:220px;">\n' +
                            '        </div>\n' +
                            '        <div class="card-body px-3 text-dark">\n' +
                            '            <div class="d-flex justify-content-between">\n' +
                            '                <p class="font-weight-semibold font-13 mb-0">'+childNodes.val().companyName+'</p>\n' +
                            '                <a href="javascript:void(0)" class=" text-muted" onClick=removeFromCart("'+x+'") style="text-align: left;"><i class="mdi mdi-cart-off" style="font-size: 24px;"></i></a>\n' +
                            '            </div>\n' +
                            '                <p class="font-weight-semibold font-13 mb-1">Type :- ' + doc.data().type + '</p>\n' +

                            '            <h5 class="font-weight-semibold"><span>RB</span>&nbsp; &nbsp;<span>5.56</span>&nbsp;&nbsp;\n' +
                            '                <span>BROWN</span>&nbsp;&nbsp; <span>VS2</span></h5>\n' +
                            '            <div class=" justify-content-between font-weight-semibold mt-4">\n' +
                            '                <p class="mb-0">\n' +
                            // '                    <i class="mdi mdi-star star-color pr-1"></i>4.60 (35) </p>\n' +
                            '                <p class="mb-0" style="text-align: center"><button type="button" class="btn btn-danger justify-content-center" onClick=showInfo("'+m+'") >Diamond info</button></p>\n' +
                            '            </div>\n' +

                            '        </div>\n' +
                            '    </div>\n' +
                            '</div>';
                        $("#names").append(refData);
                        m++;
                    } else {
                        // doc.data() will be undefined in this case
                        console.log("No such document!");
                    }
                }).catch(function (error) {
                    console.log("Error getting document:", error);
                });
            });
        });
    });

    function removeFromCart(x) {
        $("#card" + x).hide();
        firebase.database().ref("cart").child(<?php echo $userId ?>).child(x).remove();
    }

    function showInfo(m) {
        var colorBack = false;
        $("#dimaond_desciption").html("");
        var modal = document.getElementById("myModal");
        modal.style.display = "block";
        modal.style.padding = "22px";
        var d_data = docData[m].data();
        var allHtml = "";
        for (var key in d_data) {
            var sctual_key = key + "";
            if (sctual_key != 'owner' && sctual_key != 'image_url') {
                var lableColor = "#c0c0c0";
                if (colorBack)
                    lableColor = "#ffffff";
                allHtml = allHtml + "<div><p style='color:black;padding:6px; background:" + lableColor + "'><b>" + key + "</b> :- " + d_data[key] + "</p></div>";
                colorBack = !colorBack;
            }
        }
        firebase.database().ref("member").child(docData[m].data().owner + "").once("value", function (snap) {
            console.log(snap.val());
            var extraDivInfo = "<div style='width:auto;height:200px;margin-left:220px;color:black;'><center><p style='\n" +
                "    font-size: 17px;\n'>Supplier information</p></center>Company Name:- <span style='text-transform: capitalize'>" +
                snap.val().companyName + "</span><br/> Contact Number:- <span style='text-transform: capitalize'>" +
                snap.val().phoneNumber + "</span><br/><a class='btn btn-danger justify-content-center mt-3' href='supply.php?u=" + docData[m].data().owner + "'>View suppliers page</a></div>";
            $("#dimaond_desciption").html("<img src='" + docData[m].data().image_url + "' style='float:left;display:inline;' width='200px' height='200px'>" + extraDivInfo + "<br/><br/>" + allHtml);
        });
    }

    function closePopup() {
        $("#myModal").hide();
    }

</script>
<!-- container-scroller -->
<!-- base:js -->
<script src="vendors/base/vendor.bundle.base.js"></script>
<!-- endinject -->
<!-- Plugin js for this page-->
<!-- End plugin js for this page-->
<!-- inject:js -->
<script src="js/template.js"></script>
<!-- endinject -->
<!-- plugin js for this page -->
<!-- End plugin js for this page -->
<script src="vendors/chart.js/Chart.min.js"></script>
<script src="vendors/progressbar.js/progressbar.min.js"></script>
<script src="vendors/chartjs-plugin-datalabels/chartjs-plugin-datalabels.js"></script>
<script src="vendors/justgage/raphael-2.1.4.min.js"></script>
<script src="vendors/justgage/justgage.js"></script>
<!-- Custom js for this page-->
<script src="js/dashboard.js"></script>
<div id="myModal" class="modal">
    <span class="closeTab" onClick="closePopup()" style="color: white">&times;</span>

    <!-- Modal content -->
    <div class="modal-content" style="
    width: 80%;
    overflow: auto;
    height: 595px;
">
        <p id="dimaond_desciption" style="padding:10px;"></p>
    </div>

</div>
<!-- End custom js for this page-->
</body>
</html>